{
  "requirement_id": 1003,
  "file_path": "/var/fpwork/tiyi/project/MAS/MAS/api/main.py",
  "run_id": "ff2a16c8-ea03-4e68-ad57-79603f929de1",
  "performance_result": {
    "ai_performance_analysis": {
      "overall_performance_score": {
        "performance_score": 1.0,
        "performance_grade": "Critical",
        "complexity_contribution": 5.0,
        "bottleneck_impact": 7.0,
        "explanation": "åŸºäº9ä¸ªæ€§èƒ½ç“¶é¢ˆå’Œå¤æ‚åº¦åˆ†æçš„ç»¼åˆè¯„ä¼°",
        "improvement_potential": 9.0
      },
      "code_structure_analysis": {
        "language": "python",
        "framework": "unknown",
        "code_size": 15553,
        "function_count": 15,
        "class_count": 0,
        "loop_count": 14,
        "recursive_functions": [],
        "async_patterns": true,
        "database_operations": true,
        "file_operations": true,
        "network_operations": false
      },
      "complexity_analysis": {
        "error": "å¤æ‚åº¦åˆ†æå¤±è´¥: Promptæ ¼å¼åŒ–å¤±è´¥ï¼Œç¼ºå°‘å‚æ•°: '\"best_case\"'"
      },
      "performance_bottlenecks": [
        {
          "bottleneck_id": "LOOP_238",
          "type": "nested_loop",
          "description": "åµŒå¥—å¾ªç¯æ€§èƒ½ç“¶é¢ˆ (ç¬¬238è¡Œ)\n  - åµŒå¥—å±‚çº§: 2å±‚\n  - å¤–å±‚å¾ªç¯: for name, class_name in active_agents.items():\n  - å†…å±‚å¾ªç¯: total_reports = sum(len(files) for files in reports.values())\n  - æ€§èƒ½å½±å“: æ—¶é—´å¤æ‚åº¦å¯èƒ½è¾¾åˆ° O(n^2)\n  - å»ºè®®: è€ƒè™‘ä½¿ç”¨ASTè§£æã€å­—å…¸æŸ¥æ‰¾æˆ–ç”Ÿæˆå™¨ä¼˜åŒ–",
          "line_number": 238,
          "severity": "medium",
          "severity_score": 6.0,
          "details": {
            "outer_loop": "for name, class_name in active_agents.items():",
            "inner_loop": "total_reports = sum(len(files) for files in reports.values())",
            "nesting_level": 2,
            "estimated_complexity": "O(n^2)"
          }
        },
        {
          "bottleneck_id": "LOOP_370",
          "type": "nested_loop",
          "description": "åµŒå¥—å¾ªç¯æ€§èƒ½ç“¶é¢ˆ (ç¬¬370è¡Œ)\n  - åµŒå¥—å±‚çº§: 2å±‚\n  - å¤–å±‚å¾ªç¯: for f in consolidated_files:\n  - å†…å±‚å¾ªç¯: for it in data.get('issues', []):\n  - æ€§èƒ½å½±å“: æ—¶é—´å¤æ‚åº¦å¯èƒ½è¾¾åˆ° O(n^2)\n  - å»ºè®®: è€ƒè™‘ä½¿ç”¨ASTè§£æã€å­—å…¸æŸ¥æ‰¾æˆ–ç”Ÿæˆå™¨ä¼˜åŒ–",
          "line_number": 370,
          "severity": "medium",
          "severity_score": 6.0,
          "details": {
            "outer_loop": "for f in consolidated_files:",
            "inner_loop": "for it in data.get('issues', []):",
            "nesting_level": 2,
            "estimated_complexity": "O(n^2)"
          }
        },
        {
          "bottleneck_id": "RECURSION_login",
          "type": "recursion",
          "description": "é€’å½’å‡½æ•°æ€§èƒ½é£é™© - login\n  - å‡½æ•°åç§°: login\n  - é€’å½’è°ƒç”¨: asyncio.run(_login_entry(target_dir))\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
          "line_number": 1,
          "severity": "medium",
          "severity_score": 5.0,
          "details": {
            "function_name": "login",
            "recursive_call_line": "asyncio.run(_login_entry(target_dir))",
            "code_preview": "def login(target_dir):\n    \"\"\"Login å¹¶å¯é€‰å¯åŠ¨ç›®å½•åˆ†æ (åŒæ­¥åŒ…è£…)\"\"\"\n    asyncio.run(_login_entry(target_dir))\n"
          }
        },
        {
          "bottleneck_id": "RECURSION_status",
          "type": "recursion",
          "description": "é€’å½’å‡½æ•°æ€§èƒ½é£é™© - status\n  - å‡½æ•°åç§°: status\n  - é€’å½’è°ƒç”¨: asyncio.run(_status_entry())\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
          "line_number": 1,
          "severity": "medium",
          "severity_score": 5.0,
          "details": {
            "function_name": "status",
            "recursive_call_line": "asyncio.run(_status_entry())",
            "code_preview": "def status():\n    \"\"\"ç³»ç»ŸçŠ¶æ€ (åŒæ­¥åŒ…è£…)\"\"\"\n    asyncio.run(_status_entry())\n\n# ============ å…¶ä½™å‘½ä»¤ä¿æŒä¸å˜ (results / config) ============"
          }
        },
        {
          "bottleneck_id": "RECURSION_config",
          "type": "recursion",
          "description": "é€’å½’å‡½æ•°æ€§èƒ½é£é™© - config\n  - å‡½æ•°åç§°: config\n  - é€’å½’è°ƒç”¨: config_manager = get_ai_agent_config()\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
          "line_number": 1,
          "severity": "medium",
          "severity_score": 5.0,
          "details": {
            "function_name": "config",
            "recursive_call_line": "config_manager = get_ai_agent_config()",
            "code_preview": "def config():\n    \"\"\"Configure AI agent system settings\"\"\"\n    click.echo(\"\\nğŸ¤– AIæ™ºèƒ½ä½“ç³»ç»Ÿé…ç½®\")\n    \n    current_file_dir = os.path.dirname(os.path.abspath(__file__))\n    project_root = os.path.dirname(cur"
          }
        },
        {
          "bottleneck_id": "IO_DATABASE_IO_27",
          "type": "database_io",
          "description": "æ•°æ®åº“I/Oæ“ä½œ (ç¬¬27è¡Œ)\n  - æ“ä½œä»£ç : sys.path.insert(0, project_root)\n  - åŒ¹é…æ¨¡å¼: insert\n  - æ€§èƒ½å½±å“: æ•°æ®åº“æŸ¥è¯¢å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ\n  - ä¼˜åŒ–å»ºè®®: ä½¿ç”¨è¿æ¥æ± ã€æ‰¹é‡æŸ¥è¯¢ã€æ·»åŠ ç´¢å¼•ã€è€ƒè™‘ä½¿ç”¨ç¼“å­˜(Redis)ã€ä½¿ç”¨å¼‚æ­¥æ•°æ®åº“é©±åŠ¨",
          "line_number": 27,
          "severity": "low",
          "severity_score": 3.0,
          "details": {
            "io_type": "database_io",
            "operation": "sys.path.insert(0, project_root)",
            "pattern_matched": "insert",
            "optimization_priority": "medium"
          }
        },
        {
          "bottleneck_id": "IO_FILE_IO_149",
          "type": "file_io",
          "description": "æ–‡ä»¶I/Oæ“ä½œ (ç¬¬149è¡Œ)\n  - æ“ä½œä»£ç : user = await asyncio.to_thread(lambda: input(\"ä½ > \").strip())\n  - åŒ¹é…æ¨¡å¼: read(\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´ç£ç›˜I/Oé˜»å¡\n  - ä¼˜åŒ–å»ºè®®: ä½¿ç”¨å¼‚æ­¥æ–‡ä»¶æ“ä½œ(aiofiles)ã€æ‰¹é‡è¯»å†™ã€æ·»åŠ ç¼“å­˜æœºåˆ¶",
          "line_number": 149,
          "severity": "low",
          "severity_score": 3.0,
          "details": {
            "io_type": "file_io",
            "operation": "user = await asyncio.to_thread(lambda: input(\"ä½ > \").strip())",
            "pattern_matched": "read(",
            "optimization_priority": "low"
          }
        },
        {
          "bottleneck_id": "IO_DATABASE_IO_224",
          "type": "database_io",
          "description": "æ•°æ®åº“I/Oæ“ä½œ (ç¬¬224è¡Œ)\n  - æ“ä½œä»£ç : sys.path.insert(0, project_root)\n  - åŒ¹é…æ¨¡å¼: insert\n  - æ€§èƒ½å½±å“: æ•°æ®åº“æŸ¥è¯¢å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ\n  - ä¼˜åŒ–å»ºè®®: ä½¿ç”¨è¿æ¥æ± ã€æ‰¹é‡æŸ¥è¯¢ã€æ·»åŠ ç´¢å¼•ã€è€ƒè™‘ä½¿ç”¨ç¼“å­˜(Redis)ã€ä½¿ç”¨å¼‚æ­¥æ•°æ®åº“é©±åŠ¨",
          "line_number": 224,
          "severity": "low",
          "severity_score": 3.0,
          "details": {
            "io_type": "database_io",
            "operation": "sys.path.insert(0, project_root)",
            "pattern_matched": "insert",
            "optimization_priority": "medium"
          }
        },
        {
          "bottleneck_id": "IO_DATABASE_IO_270",
          "type": "database_io",
          "description": "æ•°æ®åº“I/Oæ“ä½œ (ç¬¬270è¡Œ)\n  - æ“ä½œä»£ç : sys.path.insert(0, project_root)\n  - åŒ¹é…æ¨¡å¼: insert\n  - æ€§èƒ½å½±å“: æ•°æ®åº“æŸ¥è¯¢å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ\n  - ä¼˜åŒ–å»ºè®®: ä½¿ç”¨è¿æ¥æ± ã€æ‰¹é‡æŸ¥è¯¢ã€æ·»åŠ ç´¢å¼•ã€è€ƒè™‘ä½¿ç”¨ç¼“å­˜(Redis)ã€ä½¿ç”¨å¼‚æ­¥æ•°æ®åº“é©±åŠ¨",
          "line_number": 270,
          "severity": "low",
          "severity_score": 3.0,
          "details": {
            "io_type": "database_io",
            "operation": "sys.path.insert(0, project_root)",
            "pattern_matched": "insert",
            "optimization_priority": "medium"
          }
        }
      ],
      "optimization_plan": {
        "immediate_optimizations": [],
        "algorithmic_improvements": [
          {
            "optimization_id": "LOOP_238",
            "description": "ä¼˜åŒ–å»ºè®®:åµŒå¥—å¾ªç¯æ€§èƒ½ç“¶é¢ˆ (ç¬¬238è¡Œ)\n  - åµŒå¥—å±‚çº§: 2å±‚\n  - å¤–å±‚å¾ªç¯: for name, class_name in active_agents.items():\n  - å†…å±‚å¾ªç¯: total_reports = sum(len(files) for files in reports.values())\n  - æ€§èƒ½å½±å“: æ—¶é—´å¤æ‚åº¦å¯èƒ½è¾¾åˆ° O(n^2)\n  - å»ºè®®: è€ƒè™‘ä½¿ç”¨ASTè§£æã€å­—å…¸æŸ¥æ‰¾æˆ–ç”Ÿæˆå™¨ä¼˜åŒ–",
            "priority": "medium"
          },
          {
            "optimization_id": "LOOP_370",
            "description": "ä¼˜åŒ–å»ºè®®:åµŒå¥—å¾ªç¯æ€§èƒ½ç“¶é¢ˆ (ç¬¬370è¡Œ)\n  - åµŒå¥—å±‚çº§: 2å±‚\n  - å¤–å±‚å¾ªç¯: for f in consolidated_files:\n  - å†…å±‚å¾ªç¯: for it in data.get('issues', []):\n  - æ€§èƒ½å½±å“: æ—¶é—´å¤æ‚åº¦å¯èƒ½è¾¾åˆ° O(n^2)\n  - å»ºè®®: è€ƒè™‘ä½¿ç”¨ASTè§£æã€å­—å…¸æŸ¥æ‰¾æˆ–ç”Ÿæˆå™¨ä¼˜åŒ–",
            "priority": "medium"
          },
          {
            "optimization_id": "RECURSION_login",
            "description": "ä¼˜åŒ–å»ºè®®:é€’å½’å‡½æ•°æ€§èƒ½é£é™© - login\n  - å‡½æ•°åç§°: login\n  - é€’å½’è°ƒç”¨: asyncio.run(_login_entry(target_dir))\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
            "priority": "medium"
          },
          {
            "optimization_id": "RECURSION_status",
            "description": "ä¼˜åŒ–å»ºè®®:é€’å½’å‡½æ•°æ€§èƒ½é£é™© - status\n  - å‡½æ•°åç§°: status\n  - é€’å½’è°ƒç”¨: asyncio.run(_status_entry())\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
            "priority": "medium"
          },
          {
            "optimization_id": "RECURSION_config",
            "description": "ä¼˜åŒ–å»ºè®®:é€’å½’å‡½æ•°æ€§èƒ½é£é™© - config\n  - å‡½æ•°åç§°: config\n  - é€’å½’è°ƒç”¨: config_manager = get_ai_agent_config()\n  - æ€§èƒ½å½±å“: å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºæˆ–æŒ‡æ•°çº§æ—¶é—´å¤æ‚åº¦\n  - å»ºè®®: æ£€æŸ¥æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶ã€è€ƒè™‘ä½¿ç”¨è¿­ä»£æˆ–å°¾é€’å½’ä¼˜åŒ–ã€æ·»åŠ ç¼“å­˜(memoization)",
            "priority": "medium"
          }
        ],
        "architectural_changes": [],
        "monitoring_setup": [],
        "estimated_performance_gain": "20-40%æå‡"
      },
      "testing_recommendations": [
        {
          "test_type": "æ•°æ®åº“æ€§èƒ½æµ‹è¯•",
          "description": "æµ‹è¯•æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½å’Œè¿æ¥æ± æ•ˆç‡",
          "tools": [
            "pytest-benchmark",
            "SQLAlchemy profiling"
          ],
          "priority": "high"
        },
        {
          "test_type": "å¼‚æ­¥æ€§èƒ½æµ‹è¯•",
          "description": "æµ‹è¯•å¼‚æ­¥æ“ä½œçš„å¹¶å‘æ€§èƒ½",
          "tools": [
            "pytest-asyncio",
            "asyncio profiling"
          ],
          "priority": "high"
        }
      ],
      "ai_confidence": 0.88,
      "model_used": "microsoft/codebert-base",
      "analysis_timestamp": "2025-12-02T08:22:57.918862"
    },
    "analysis_status": "completed"
  },
  "generated_at": "2025-12-02T08:22:57.918872"
}